now calling ./run_3flows.sh  ..
mylist=tc10_data_setup.sh
tc13_data_setup.sh
tc14_data_setup.sh
tc1_data_setup.sh
tc20_data_setup.sh
tc2_data_setup.sh
tc3_data_setup.sh
tc4_data_setup.sh
tc5_data_setup.sh
tc6_data_setup.sh
tc7_data_setup.sh
tc88_data_setup.sh
tc8_data_setup.sh
cleaning out /opt/app/sas/custom/data
creating /opt/app/sas/custom/data
creating /opt/app/sas/custom/data/error_messages
creating /opt/app/sas/custom/data/pcrf_files_prepaid
creating /opt/app/sas/custom/data/pcrf_files_postpaid
creating /opt/app/sas/custom/data/lookup_paymenttype
creating /opt/app/sas/custom/data/lookup_recurring
creating /opt/app/sas/custom/data/output_prepaid
creating /opt/app/sas/custom/data/output_postpaid
creating /opt/app/sas/custom/data/output_fonic
creating /opt/app/sas/custom/data/bad_server_events
creating /opt/app/sas/custom/data/persist_fonic_throttle_event
creating /opt/app/sas/custom/data/persist_prepaid_throttle_event
creating /opt/app/sas/custom/data/persist_postpaid_throttle_event
############################################################################
starting tc10 at Mon Apr  7 00:24:26 PDT 2014..
running test at Mon Apr  7 00:24:26 PDT 2014
copying start_stop_dir/EDR_PCRF_V6.36-POSTPAID_RAMP_UP_A.xml to start_stop_dir/POSTPAID_load.xml..
tc10:
R10: for phase A the following QuotaNames are allowed for postpaid: 
Q_68_local_Month', 'Q_72_local_Month', 'Q_74_local_Month', 'Q_81_local_Month', 'Q_109_local_Month', 'Q_117_local_Month', 'Q_127_local_Month'
 
 
 
test strategy:
input various combinations of QuotaName, TriggerType, QuotaStatus and QuotaValue 
to confirm only valid combinations result in a processed postpaid throttle 100 event
 
EDR data setup:
Row1: a not valid POSTPAID throttle 100 event (Quota_Name=Q_110_local_Month, TriggerType=2, Quota_Status=6, QuotaValue=1)
Row2: a valid POSTPAID throttle 100 event (Quota_Name=Q_109_local_Month, TriggerType=2, Quota_Status=6, QuotaValue=1)
Row3: a valid POSTPAID throttle 100 event (Quota_Name=Q_68_local_Month, TriggerType=2, Quota_Status=6, QuotaValue=1)
Row4: a valid POSTPAID throttle 100 event (Quota_Name=Q_72_local_Month, TriggerType=2, Quota_Status=6, QuotaValue=1)
Row5: a valid POSTPAID throttle 100 event (Quota_Name=Q_81_local_Month, TriggerType=2, Quota_Status=6, QuotaValue=1)
Row6: a valid POSTPAID throttle 100 event (Quota_Name=Q_74_local_Month, TriggerType=2, Quota_Status=6, QuotaValue=1)
Row7: a valid POSTPAID throttle 100 event (Quota_Name=Q_117_local_Month, TriggerType=2, Quota_Status=6, QuotaValue=1)
Row8: a valid POSTPAID throttle 100 event (Quota_Name=Q_127_local_Month, TriggerType=2, Quota_Status=6, QuotaValue=1)
 

tc10: 1. PCRF EDRs (input stream)..
tc10: 2. postpaid lkp..
tc10: 3. recurring lkp..
tc10: 4. generating the expected output..
 
here is the contents we were looking for..
I,N:2014-04-07 00:24:26,4912345678902,Q_109_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:24:26,4912345678903,Q_68_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:24:26,4912345678904,Q_72_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:24:26,4912345678905,Q_81_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:24:26,4912345678906,Q_74_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:24:26,4912345678907,Q_117_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:24:26,4912345678908,Q_127_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
 
here is the postpaid lookup we used..
4912345678901,POSTPAID
4912345678902,POSTPAID
4912345678903,POSTPAID
4912345678904,POSTPAID
4912345678905,POSTPAID
4912345678906,POSTPAID
4912345678907,POSTPAID
4912345678908,POSTPAID
 
here is the recurring lookup we used..
4912345678901,Q_110_local_Month,1230,Y
4912345678902,Q_109_local_Month,1230,Y
4912345678903,Q_68_local_Month,1230,Y
4912345678904,Q_72_local_Month,1230,Y
4912345678905,Q_81_local_Month,1230,Y
4912345678906,Q_74_local_Month,1230,Y
4912345678907,Q_117_local_Month,1230,Y
4912345678908,Q_127_local_Month,1230,Y
 
here is the EDR stream we used..
2,2014-04-07 00:24:26,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:24:26,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:24:26,,,4912345678902,,,,,,,,,,,,,,,,,,,,,,Q_109_local_Month,6,,,,1024,2014-04-23 00:24:26,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:24:26,,,4912345678903,,,,,,,,,,,,,,,,,,,,,,Q_68_local_Month,6,,,,1024,2014-04-23 00:24:26,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:24:26,,,4912345678904,,,,,,,,,,,,,,,,,,,,,,Q_72_local_Month,6,,,,1024,2014-04-23 00:24:26,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:24:26,,,4912345678905,,,,,,,,,,,,,,,,,,,,,,Q_81_local_Month,6,,,,1024,2014-04-23 00:24:26,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:24:26,,,4912345678906,,,,,,,,,,,,,,,,,,,,,,Q_74_local_Month,6,,,,1024,2014-04-23 00:24:26,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:24:26,,,4912345678907,,,,,,,,,,,,,,,,,,,,,,Q_117_local_Month,6,,,,1024,2014-04-23 00:24:26,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:24:26,,,4912345678908,,,,,,,,,,,,,,,,,,,,,,Q_127_local_Month,6,,,,1024,2014-04-23 00:24:26,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
calling ./START_CEP_ENGINE.sh  
cd /home/sal/Desktop/dev/2.2-pre/bin
starting the cep server at Mon Apr  7 00:24:27 PDT 2014..
./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt >> /home/sal/sals_tests/cep_server.log
running in the following cep server process..
sal       2640  3.7  0.9 518076 17872 pts/0    Sl+  00:24   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
calling ./START_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:24:30 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_load.xml
<response action='load' name='POSTPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='60 ms'>
    <message>project load POSTPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_postpaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:24:33 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_load.xml
<response action='load' name='PREPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='35 ms'>
    <message>project load PREPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_prepaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:24:36 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_load.xml
<response action='load' name='FONIC_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='27 ms'>
    <message>project load FONIC_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_start.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_fonic_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_ADAPTER.sh  
cd /home/sal/sals_tests/try9
starting the cep adapter.. java -jar o2-adapters-pcrf-2.12.2_external_camel_context.jar >> /home/sal/sals_tests/cep_adapter.log
running in the following cep adapter process..
sal       2640  2.3  1.7 1319508 33652 pts/0   Sl+  00:24   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
waiting for /opt/app/sas/custom/data/output_postpaid/result.csv to be created..
waiting for /opt/app/sas/custom/data/output_postpaid/result.csv to be created..
tc10:11. now we can compare results..
here is the contents we were looking for..
I,N:2014-04-07 00:24:26,4912345678902,Q_109_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:24:26,4912345678903,Q_68_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:24:26,4912345678904,Q_72_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:24:26,4912345678905,Q_81_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:24:26,4912345678906,Q_74_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:24:26,4912345678907,Q_117_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:24:26,4912345678908,Q_127_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
here is what we got..
I,N:2014-04-07 00:24:26,4912345678901,Q_110_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:24:26,4912345678902,Q_109_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:24:26,4912345678903,Q_68_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:24:26,4912345678904,Q_72_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:24:26,4912345678905,Q_81_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:24:26,4912345678906,Q_74_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:24:26,4912345678907,Q_117_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:24:26,4912345678908,Q_127_local_Month,2014-04-23 00:24:26,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
calling ./STOP_CEP_ADAPTER.sh  
killing 2844..
waiting on the following processes to stop..
2844
calling ./STOP_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:24:56 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_postpaid_throttle_event' project='POSTPAID_THROTTLE_EVENT' elapsed='5 ms'>
    <message>project 'POSTPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_postpaid_throttle_event'</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:24:59 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_prepaid_throttle_event' project='PREPAID_THROTTLE_EVENT' elapsed='9 ms'>
    <message>project 'PREPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_prepaid_throttle_event'</message>
</response>

<response action='remove' name='POSTPAID_THROTTLE_EVENT' elapsed='1292 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:25:02 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_fonic_throttle_event' project='FONIC_THROTTLE_EVENT' elapsed='8 ms'>
    <message>project 'FONIC_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_fonic_throttle_event'</message>
</response>

<response action='remove' name='PREPAID_THROTTLE_EVENT' elapsed='1248 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_stop.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_ENGINE.sh  
killing 2640..
waiting on the following processes to stop..

ending tc10 at Mon Apr  7 00:25:08 PDT 2014..
############################################################################
############################################################################
starting tc13 at Mon Apr  7 00:25:08 PDT 2014..
running test at Mon Apr  7 00:25:08 PDT 2014
TC13:
R13: the CEP Engine delivers PREPAID throttle 100 events with various metrics.
EDRs which have a local QuotaName and TriggerType 1 to 6 are of interest.
Throttle 100 events have the QuotaStatus=6 and QuotaValue=1.
 
 
test strategy:
we make sure the join between the postpaid throttle 100 event works correctly
(via msisdn and  the QuotaName). We also confirm that when no lookup entry is 
found, the postpaid throttle 100 event reaches the output but with these 2 
attributes empty. E.g. prepaid throttle 100 events shouldnt be seen in the output of the CEP Engine.
 
 
EDR data setup:
Row1: a POSTPAID throttle 100, Quota_name=Q_110_local_Month
Row2: a POSTPAID throttle 100, Quota_name=Q_444_local_Month
 
 
Recurring Lookup Setup:
Row1: same msisdn but different quota name, is_recurring=Y, InitVol=1230
Row2: same msisdn and quota name as in the edr event, is_recurring=N, InitVol=1777

tc13: 1. PCRD EDRs (input stream)..
tc13: 2. postpaid lkp..
tc13: 3. recurring lkp..
tc13: 4. generating the expected output..
 
here is the contents we were looking for..
I,N:2014-04-07 00:15:08,4912345678901,Q_110_local_Month,2014-04-23 00:25:08,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,N,1777
I,N:2014-04-07 00:15:08,4912345678902,Q_444_local_Month,2014-04-23 00:25:08,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,,
 
here is the postpaid lookup we used..
4912345678901,POSTPAID
4912345678902,POSTPAID
 
here is the recurring lookup we used..
4912345678901,Q_111_local_Month,1230,Y
4912345678901,Q_110_local_Month,1777,N
 
here is the EDR stream we used..
2,2014-04-07 00:15:08,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,100,2014-04-23 00:25:08,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:15:08,,,4912345678902,,,,,,,,,,,,,,,,,,,,,,Q_444_local_Month,6,,,,100,2014-04-23 00:25:08,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
calling ./START_CEP_ENGINE.sh  
cd /home/sal/Desktop/dev/2.2-pre/bin
starting the cep server at Mon Apr  7 00:25:08 PDT 2014..
./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt >> /home/sal/sals_tests/cep_server.log
running in the following cep server process..
sal       3182  1.0  0.8 518080 15832 pts/0    Sl+  00:25   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
calling ./START_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:25:11 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_load.xml
<response action='load' name='POSTPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='22 ms'>
    <message>project load POSTPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_postpaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:25:14 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_load.xml
<response action='load' name='PREPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='24 ms'>
    <message>project load PREPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_prepaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:25:17 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_load.xml
<response action='load' name='FONIC_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='23 ms'>
    <message>project load FONIC_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_start.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_fonic_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_ADAPTER.sh  
cd /home/sal/sals_tests/try9
starting the cep adapter.. java -jar o2-adapters-pcrf-2.12.2_external_camel_context.jar >> /home/sal/sals_tests/cep_adapter.log
running in the following cep adapter process..
sal       3182  0.9  1.6 1319512 31612 pts/0   Sl+  00:25   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
waiting for /opt/app/sas/custom/data/output_postpaid/result.csv to be created..
tc13:11. now we can compare results..
here is the contents we were looking for..
I,N:2014-04-07 00:15:08,4912345678901,Q_110_local_Month,2014-04-23 00:25:08,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,N,1777
I,N:2014-04-07 00:15:08,4912345678902,Q_444_local_Month,2014-04-23 00:25:08,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,,
here is what we got..
I,N:2014-04-07 00:15:08,4912345678901,Q_110_local_Month,2014-04-23 00:25:08,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,N,1777
I,N:2014-04-07 00:15:08,4912345678902,Q_444_local_Month,2014-04-23 00:25:08,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,,
tc13: RESULT: FAILURE!!! (no bad files expected but some were found.. tc13_EDR_UPCC231_MPU484_4924_40131211100031.csv.gz)
calling ./STOP_CEP_ADAPTER.sh  
killing 3352..
waiting on the following processes to stop..
3352
calling ./STOP_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:25:33 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_postpaid_throttle_event' project='POSTPAID_THROTTLE_EVENT' elapsed='3 ms'>
    <message>project 'POSTPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_postpaid_throttle_event'</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:25:36 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_prepaid_throttle_event' project='PREPAID_THROTTLE_EVENT' elapsed='3 ms'>
    <message>project 'PREPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_prepaid_throttle_event'</message>
</response>

<response action='remove' name='POSTPAID_THROTTLE_EVENT' elapsed='1317 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:25:39 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_fonic_throttle_event' project='FONIC_THROTTLE_EVENT' elapsed='4 ms'>
    <message>project 'FONIC_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_fonic_throttle_event'</message>
</response>

<response action='remove' name='PREPAID_THROTTLE_EVENT' elapsed='1313 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_stop.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_ENGINE.sh  
killing 3182..
waiting on the following processes to stop..
3182
ending tc13 at Mon Apr  7 00:25:45 PDT 2014..
############################################################################
############################################################################
starting tc14 at Mon Apr  7 00:25:45 PDT 2014..
running test at Mon Apr  7 00:25:45 PDT 2014
tc14:
R14: The is_recurring flag and the InitialVolume come from the recurring lookup. 
The join is via msisdn and QuotaName to the throttle 100 prepaid events.
 
 
test strategy:
input various combinations of QuotaName, TriggerType, QuotaStatus and QuotaValue 
to confirm only valid combinations result in a processed prepaid throttle 100 event
 
EDR data setup:
Row1: a valid PREPAID throttle 100 event (Quota_Name=Q_110_local_Month, TriggerType=2, Quota_Status=6, QuotaValue=1)
Row2: a not valid PREPAID throttle 100 event (TriggerType=7 instead of 1-6)
Row3: a not valid PREPAID throttle 100 event (Quota_Name = Q_110_roaming_Month)
Row4: a not valid PREPAID throttle 100 event (Quota_Status=4 instead of 6)
Row5: a not valid PREPAID throttle 100 event (QuotaValue=11 instead of 1)
Row6: a not valid PREPAID throttle 100 event (as its POSTPAID)
 

tc14: 1. PCRF EDRs (input stream)..
tc14: 2. prepaid lkp..
tc14: 3. recurring lkp..
tc14: 4. generating the expected output..
 
here is the contents we were looking for..
I,N:2014-04-07 00:25:45,4912345678901,Q_110_local_Month,2014-04-23 00:25:46,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,PREPAID,1024,Y,1230
 
here is the prepaid lookup we used..
4912345678901,PREPAID
4922345678902,PREPAID
4922345678903,PREPAID
4922345678904,PREPAID
4922345678905,PREPAID
4922345678906,POSTPAID
 
here is the recurring lookup we used..
4912345678901,Q_110_local_Month,1230,Y
4922345678902,Q_110_local_Month,1230,Y
4922345678903,Q_110_local_Month,1230,Y
4922345678904,Q_110_local_Month,1230,Y
 
here is the EDR stream we used..
2,2014-04-07 00:25:45,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:25:46,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
7,2014-04-07 00:25:45,,,4922345678902,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:25:46,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:25:45,,,4922345678903,,,,,,,,,,,,,,,,,,,,,,Q_110_roaming_Month,6,,,,1024,2014-04-23 00:25:46,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:25:45,,,4922345678904,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,4,,,,1024,2014-04-23 00:25:46,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:25:45,,,4922345678905,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,4,,,,1024,2014-04-23 00:25:46,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,11,,
2,2014-04-07 00:25:45,,,4922345678906,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:25:46,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
calling ./START_CEP_ENGINE.sh  
cd /home/sal/Desktop/dev/2.2-pre/bin
starting the cep server at Mon Apr  7 00:25:46 PDT 2014..
./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt >> /home/sal/sals_tests/cep_server.log
running in the following cep server process..
sal       3699  0.7  0.7 518080 13788 pts/0    Sl+  00:25   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
calling ./START_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:25:49 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_load.xml
<response action='load' name='POSTPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='25 ms'>
    <message>project load POSTPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_postpaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:25:52 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_load.xml
<response action='load' name='PREPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='25 ms'>
    <message>project load PREPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_prepaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:25:55 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_load.xml
<response action='load' name='FONIC_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='23 ms'>
    <message>project load FONIC_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_start.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_fonic_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_ADAPTER.sh  
cd /home/sal/sals_tests/try9
starting the cep adapter.. java -jar o2-adapters-pcrf-2.12.2_external_camel_context.jar >> /home/sal/sals_tests/cep_adapter.log
running in the following cep adapter process..
sal       3699  0.9  1.4 1319512 27552 pts/0   Sl+  00:25   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
waiting for /opt/app/sas/custom/data/output_prepaid/result.csv to be created..
tc14:11. now we can compare results..
here is the contents we were looking for..
I,N:2014-04-07 00:25:45,4912345678901,Q_110_local_Month,2014-04-23 00:25:46,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,PREPAID,1024,Y,1230
here is what we got..
I,N:2014-04-07 00:25:45,4912345678901,Q_110_local_Month,2014-04-23 00:25:46,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,PREPAID,1024,Y,1230
tc14: RESULT: FAILURE!!! (no bad files expected but some were found.. tc14_EDR_UPCC231_MPU484_4924_40131211100031.csv.gz)
calling ./STOP_CEP_ADAPTER.sh  
killing 3870..
waiting on the following processes to stop..
3870
calling ./STOP_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:26:11 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_postpaid_throttle_event' project='POSTPAID_THROTTLE_EVENT' elapsed='3 ms'>
    <message>project 'POSTPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_postpaid_throttle_event'</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:26:14 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_prepaid_throttle_event' project='PREPAID_THROTTLE_EVENT' elapsed='3 ms'>
    <message>project 'PREPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_prepaid_throttle_event'</message>
</response>

<response action='remove' name='POSTPAID_THROTTLE_EVENT' elapsed='1286 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:26:17 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_fonic_throttle_event' project='FONIC_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'FONIC_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_fonic_throttle_event'</message>
</response>

<response action='remove' name='PREPAID_THROTTLE_EVENT' elapsed='1287 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_stop.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_ENGINE.sh  
killing 3699..
waiting on the following processes to stop..
3699
ending tc14 at Mon Apr  7 00:26:23 PDT 2014..
############################################################################
############################################################################
starting tc1 at Mon Apr  7 00:26:23 PDT 2014..
running test at Mon Apr  7 00:26:23 PDT 2014
TC1:
R1: the CEP Engine delivers POSTPAID throttle 100 events with various metrics.
EDRs which have a local QuotaName and TriggerType 1 to 6 are of interest.
Throttle 100 events have the QuotaStatus=6 and QuotaValue=1.
 
 
test strategy:
input various combinations of QuotaName, TriggerType, QuotaStatus and QuotaValue 
to confirm only valid combinations result in a processed postpaid throttle 100 event
 
EDR data setup:
Row1: a valid POSTPAID throttle 100 event (Quota_Name=Q_110_local_Month, TriggerType=2, Quota_Status=6, QuotaValue=1)
Row2: a not valid POSTPAID throttle 100 event (TriggerType=7 instead of 1-6)
Row3: a not valid POSTPAID throttle 100 event (Quota_Name = Q_110_roaming_Month)
Row4: a not valid POSTPAID throttle 100 event (Quota_Status=4 instead of 6)
Row5: a not valid POSTPAID throttle 100 event (QuotaValue=11 instead of 1)
Row6: a not valid POSTPAID throttle 100 event (as its PREPAID)
 

TC1: 1. PCRF EDRs (input stream)..
TC1: 2. postpaid lkp..
TC1: 3. recurring lkp..
TC1: 4. generating the expected output..
 
here is the contents we were looking for..
I,N:2014-04-07 00:26:23,4912345678901,Q_110_local_Month,2014-04-23 00:26:23,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
 
here is the postpaid lookup we used..
4912345678901,POSTPAID
4912345678902,POSTPAID
4912345678903,POSTPAID
4912345678904,POSTPAID
4912345678905,POSTPAID
4912345678906,PREPAID
 
here is the recurring lookup we used..
4912345678901,Q_110_local_Month,1230,Y
4912345678902,Q_110_local_Month,1230,Y
4912345678903,Q_110_local_Month,1230,Y
4912345678904,Q_110_local_Month,1230,Y
 
here is the EDR stream we used..
2,2014-04-07 00:26:23,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:26:23,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
7,2014-04-07 00:26:23,,,4912345678902,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:26:23,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:26:23,,,4912345678903,,,,,,,,,,,,,,,,,,,,,,Q_110_roaming_Month,6,,,,1024,2014-04-23 00:26:23,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:26:23,,,4912345678904,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,4,,,,1024,2014-04-23 00:26:23,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:26:23,,,4912345678905,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,4,,,,1024,2014-04-23 00:26:23,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,11,,
2,2014-04-07 00:26:23,,,4912345678906,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:26:23,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
calling ./START_CEP_ENGINE.sh  
cd /home/sal/Desktop/dev/2.2-pre/bin
starting the cep server at Mon Apr  7 00:26:23 PDT 2014..
./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt >> /home/sal/sals_tests/cep_server.log
running in the following cep server process..
sal       4216  0.7  0.8 518076 15828 pts/0    Sl+  00:26   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
calling ./START_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:26:26 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_load.xml
<response action='load' name='POSTPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='26 ms'>
    <message>project load POSTPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_postpaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:26:29 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_load.xml
<response action='load' name='PREPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='25 ms'>
    <message>project load PREPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_prepaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:26:32 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_load.xml
<response action='load' name='FONIC_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='24 ms'>
    <message>project load FONIC_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_start.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_fonic_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_ADAPTER.sh  
cd /home/sal/sals_tests/try9
starting the cep adapter.. java -jar o2-adapters-pcrf-2.12.2_external_camel_context.jar >> /home/sal/sals_tests/cep_adapter.log
running in the following cep adapter process..
sal       4216  0.9  1.6 1319508 31604 pts/0   Sl+  00:26   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
waiting for /opt/app/sas/custom/data/output_postpaid/result.csv to be created..
tc1:11. now we can compare results..
here is the contents we were looking for..
I,N:2014-04-07 00:26:23,4912345678901,Q_110_local_Month,2014-04-23 00:26:23,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
here is what we got..
I,N:2014-04-07 00:26:23,4912345678901,Q_110_local_Month,2014-04-23 00:26:23,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
tc1: RESULT: FAILURE!!! (no bad files expected but some were found.. tc1_EDR_UPCC231_MPU484_4924_40131211100031.csv.gz)
calling ./STOP_CEP_ADAPTER.sh  
killing 4386..
waiting on the following processes to stop..
4386
calling ./STOP_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:26:48 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_postpaid_throttle_event' project='POSTPAID_THROTTLE_EVENT' elapsed='3 ms'>
    <message>project 'POSTPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_postpaid_throttle_event'</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:26:51 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_prepaid_throttle_event' project='PREPAID_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'PREPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_prepaid_throttle_event'</message>
</response>

<response action='remove' name='POSTPAID_THROTTLE_EVENT' elapsed='1274 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:26:54 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_fonic_throttle_event' project='FONIC_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'FONIC_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_fonic_throttle_event'</message>
</response>

<response action='remove' name='PREPAID_THROTTLE_EVENT' elapsed='1271 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_stop.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_ENGINE.sh  
killing 4216..
waiting on the following processes to stop..
4216
ending tc1 at Mon Apr  7 00:27:00 PDT 2014..
############################################################################
############################################################################
starting tc20 at Mon Apr  7 00:27:00 PDT 2014..
running test at Mon Apr  7 00:27:00 PDT 2014
TC20:
R20: When the data for the primary columns is partially / fully empty, 
they get redirected to the bad_events subfolder (for possible later analysis).
The other records in the EDR stream should still be processed by the CEP engine.
 
 
test strategy:
we have a set of good followed by bad entries, testing different possible bad entries.
The bad entries should go into the bad_events subfolder.
The good entres should be processed properly by the CEP Engine.
attributes empty. E.g. prepaid throttle 100 events shouldnt be seen in the output of the CEP Engine.
 
 
EDR data setup:
Row1: a valid POSTPAID throttle 100 EDR
Row2: an invalid POSTPAID throttle 100 EDR (no msisdn)
Row3: a valid POSTPAID throttle 100 EDR
Row4: an invalid POSTPAID throttle 100 EDR (no time)
Row5: a valid POSTPAID throttle 100 EDR
Row6: an invalid POSTPAID throttle 100 EDR (no quota name)
Row7: a valid POSTPAID throttle 100 EDR
Row8: an invalid POSTPAID throttle 100 EDR (no Quota_Next_Reset_Time)
Row9: a valid POSTPAID throttle 100 EDR
Row10: an invalid POSTPAID throttle 100 EDR (invalid time)
Row11: a valid POSTPAID throttle 100 EDR
Row12: an invalid POSTPAID throttle 100 EDR (invalid Quota_Next_Reset_Time)
Row13: a valid POSTPAID throttle 100 EDR
 
 
tc20: 1. PCRD EDRs (input stream)..
tc20: 2. postpaid lkp..
tc20: 3. recurring lkp..
tc20: 4. generating the expected output..
 
here is the contents we were looking for..
I,N:2014-04-07 00:17:00,4912345678901,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,Y,1230
I,N:2014-04-07 00:17:00,4912345678903,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,Y,1230
I,N:2014-04-07 00:17:00,4912345678905,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,,
I,N:2014-04-07 00:17:00,4912345678907,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,,
I,N:2014-04-07 00:17:00,4912345678909,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,,
I,N:2014-04-07 00:17:00,4912345678911,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,,
I,N:2014-04-07 00:17:00,4912345678913,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,,
 
here is the postpaid lookup we used..
4912345678901,POSTPAID
4912345678902,POSTPAID
4912345678903,POSTPAID
4912345678904,POSTPAID
4912345678905,POSTPAID
4912345678906,POSTPAID
4912345678907,POSTPAID
4912345678908,POSTPAID
4912345678909,POSTPAID
4912345678910,POSTPAID
4912345678911,POSTPAID
4912345678912,POSTPAID
4912345678913,POSTPAID
 
here is the recurring lookup we used..
4912345678901,Q_110_local_Month,1230,Y
4912345678902,Q_110_local_Month,1230,Y
4912345678903,Q_110_local_Month,1230,Y
 
here is the EDR stream we used..
2,2014-04-07 00:17:00,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,100,2014-04-23 00:27:00,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:17:00,,,,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,100,2014-04-23 00:27:00,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:17:00,,,4912345678903,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,100,2014-04-23 00:27:00,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,,,,4912345678904,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,100,2014-04-23 00:27:00,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:17:00,,,4912345678905,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,100,2014-04-23 00:27:00,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:17:00,,,4912345678906,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,2014-04-23 00:27:00,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:17:00,,,4912345678907,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,100,2014-04-23 00:27:00,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:17:00,,,4912345678908,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,100,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:17:00,,,4912345678909,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,100,2014-04-23 00:27:00,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,,,,4912345678910,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,100,2014-04-23 00:27:00,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:17:00,,,4912345678911,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,100,2014-04-23 00:27:00,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:17:00,,,4912345678912,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,100,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:17:00,,,4912345678913,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,100,2014-04-23 00:27:00,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
calling ./START_CEP_ENGINE.sh  
cd /home/sal/Desktop/dev/2.2-pre/bin
starting the cep server at Mon Apr  7 00:27:01 PDT 2014..
./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt >> /home/sal/sals_tests/cep_server.log
running in the following cep server process..
sal       4741  0.7  0.7 518076 13784 pts/0    Sl+  00:27   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
calling ./START_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:27:04 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_load.xml
<response action='load' name='POSTPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='27 ms'>
    <message>project load POSTPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_postpaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:27:07 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_load.xml
<response action='load' name='PREPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='25 ms'>
    <message>project load PREPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_prepaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:27:10 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_load.xml
<response action='load' name='FONIC_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='20 ms'>
    <message>project load FONIC_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_start.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_fonic_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_ADAPTER.sh  
cd /home/sal/sals_tests/try9
starting the cep adapter.. java -jar o2-adapters-pcrf-2.12.2_external_camel_context.jar >> /home/sal/sals_tests/cep_adapter.log
running in the following cep adapter process..
sal       4741  0.9  1.5 1319508 29560 pts/0   Sl+  00:27   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
waiting for /opt/app/sas/custom/data/output_postpaid/result.csv to be created..
tc20:11. now we can compare results..
checking for expected bad file tc20_EDR_UPCC231_MPU484_4924_40131211100031.csv.gz in /opt/app/sas/custom/data/error_messages..
here is the contents we were looking for..
I,N:2014-04-07 00:17:00,4912345678901,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,Y,1230
I,N:2014-04-07 00:17:00,4912345678903,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,Y,1230
I,N:2014-04-07 00:17:00,4912345678905,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,,
I,N:2014-04-07 00:17:00,4912345678907,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,,
I,N:2014-04-07 00:17:00,4912345678909,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,,
I,N:2014-04-07 00:17:00,4912345678911,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,,
I,N:2014-04-07 00:17:00,4912345678913,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,,
here is what we got..
I,N:2014-04-07 00:17:00,4912345678901,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,Y,1230
I,N:2014-04-07 00:17:00,4912345678903,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,Y,1230
I,N:2014-04-07 00:17:00,4912345678905,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,,
I,N:2014-04-07 00:17:00,4912345678907,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,,
I,N:2014-04-07 00:17:00,4912345678909,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,,
I,N:2014-04-07 00:17:00,4912345678911,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,,
I,N:2014-04-07 00:17:00,4912345678913,Q_110_local_Month,2014-04-23 00:27:00,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,100,,
tc20: RESULT: SUCCESS!!! (bad files expected and all found)
calling ./STOP_CEP_ADAPTER.sh  
killing 4912..
waiting on the following processes to stop..
4912
calling ./STOP_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:27:26 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_postpaid_throttle_event' project='POSTPAID_THROTTLE_EVENT' elapsed='3 ms'>
    <message>project 'POSTPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_postpaid_throttle_event'</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:27:29 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_prepaid_throttle_event' project='PREPAID_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'PREPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_prepaid_throttle_event'</message>
</response>

<response action='remove' name='POSTPAID_THROTTLE_EVENT' elapsed='1287 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:27:32 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_fonic_throttle_event' project='FONIC_THROTTLE_EVENT' elapsed='3 ms'>
    <message>project 'FONIC_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_fonic_throttle_event'</message>
</response>

<response action='remove' name='PREPAID_THROTTLE_EVENT' elapsed='1278 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_stop.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_ENGINE.sh  
killing 4741..
waiting on the following processes to stop..
4741
ending tc20 at Mon Apr  7 00:27:38 PDT 2014..
############################################################################
############################################################################
starting tc2 at Mon Apr  7 00:27:38 PDT 2014..
running test at Mon Apr  7 00:27:38 PDT 2014
TC2:
R1: the CEP Engine delivers POSTPAID throttle 100 events with various metrics.
EDRs which have a local QuotaName and TriggerType 1 to 6 are of interest.
Throttle 100 events have the QuotaStatus=6 and QuotaValue=1.
 
 
test strategy:
we try various valid and invalid postpaid throttle 100 events and make sure
the good ones are cleanly processed and none are skipped (this was a bug in the CEP engine!!!!)
 
EDR data setup:
Row1: a valid POSTPAID throttle 100 event (Quota_Name=Q_110_local_Month, TriggerType=2, Quota_Status=6, QuotaValue=1)
Row2: a valid POSTPAID throttle 100 event
Row3: a not valid POSTPAID throttle 100 event (TriggerType=7 instead of 1-6)
Row4: a not valid POSTPAID throttle 100 event (Quota_Status=4 instead of 6)
Row5: a not valid POSTPAID throttle 100 event (QuotaValue=11 instead of 1)
Row6: a PREPAID throttle 100 event - it should be igonored
Row7: a FONIC throttle 100 event - it should be igonored
Row8: a POSTPAID throttle 100 event - it should be processed
Row9: a not valid postpaid throttle 100 event (Quota_Name = Q_110_roaming_Month)
 

TC2: 1. PCRD EDRs (input stream)..
TC2: 2. postpaid lkp..
TC2: 3. recurring lkp..
TC2: 4. generating the expected output..
 
here is the contents we were looking for..
I,N:2014-04-07 00:27:38,4912345678901,Q_110_local_Month,2014-04-23 00:27:38,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:27:38,4912345678902,Q_110_local_Month,2014-04-23 00:27:38,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:27:38,4912345678908,Q_110_local_Month,2014-04-23 00:27:38,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
 
here is the postpaid lookup we used..
4912345678901,POSTPAID
4912345678902,POSTPAID
4912345678903,POSTPAID
4912345678904,POSTPAID
4912345678905,POSTPAID
4912345678906,PREPAID
4912345678907,FONIC
4912345678908,POSTPAID
4912345678909,POSTPAID
 
here is the recurring lookup we used..
4912345678901,Q_110_local_Month,1230,Y
4912345678902,Q_110_local_Month,1230,Y
4912345678903,Q_110_local_Month,1230,Y
4912345678904,Q_110_local_Month,1230,Y
4912345678908,Q_110_local_Month,1230,Y
 
here is the EDR stream we used..
2,2014-04-07 00:27:38,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:27:38,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:27:38,,,4912345678902,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:27:38,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
7,2014-04-07 00:27:38,,,4912345678903,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:27:38,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:27:38,,,4912345678904,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,4,,,,1024,2014-04-23 00:27:38,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:27:38,,,4912345678905,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:27:38,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,11,,
2,2014-04-07 00:27:38,,,4912345678906,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:27:38,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:27:38,,,4912345678907,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:27:38,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:27:38,,,4912345678908,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:27:38,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:27:38,,,4912345678909,,,,,,,,,,,,,,,,,,,,,,Q_110_roaming_Month,6,,,,1024,2014-04-23 00:27:38,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
calling ./START_CEP_ENGINE.sh  
cd /home/sal/Desktop/dev/2.2-pre/bin
starting the cep server at Mon Apr  7 00:27:38 PDT 2014..
./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt >> /home/sal/sals_tests/cep_server.log
running in the following cep server process..
sal       5272  0.7  0.7 518080 13784 pts/0    Sl+  00:27   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
calling ./START_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:27:41 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_load.xml
<response action='load' name='POSTPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='26 ms'>
    <message>project load POSTPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_postpaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:27:44 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_load.xml
<response action='load' name='PREPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='20 ms'>
    <message>project load PREPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_prepaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:27:47 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_load.xml
<response action='load' name='FONIC_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='23 ms'>
    <message>project load FONIC_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_start.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_fonic_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_ADAPTER.sh  
cd /home/sal/sals_tests/try9
starting the cep adapter.. java -jar o2-adapters-pcrf-2.12.2_external_camel_context.jar >> /home/sal/sals_tests/cep_adapter.log
running in the following cep adapter process..
sal       5272  0.9  1.5 1319512 29552 pts/0   Sl+  00:27   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
waiting for /opt/app/sas/custom/data/output_postpaid/result.csv to be created..
tc2:11. now we can compare results..
here is the contents we were looking for..
I,N:2014-04-07 00:27:38,4912345678901,Q_110_local_Month,2014-04-23 00:27:38,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:27:38,4912345678902,Q_110_local_Month,2014-04-23 00:27:38,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:27:38,4912345678908,Q_110_local_Month,2014-04-23 00:27:38,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
here is what we got..
I,N:2014-04-07 00:27:38,4912345678901,Q_110_local_Month,2014-04-23 00:27:38,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:27:38,4912345678902,Q_110_local_Month,2014-04-23 00:27:38,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
I,N:2014-04-07 00:27:38,4912345678908,Q_110_local_Month,2014-04-23 00:27:38,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,POSTPAID,1024,Y,1230
tc2: RESULT: FAILURE!!! (no bad files expected but some were found.. tc2_EDR_UPCC231_MPU484_4924_40131211100031.csv.gz)
calling ./STOP_CEP_ADAPTER.sh  
killing 5442..
waiting on the following processes to stop..
5442
calling ./STOP_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:28:03 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_postpaid_throttle_event' project='POSTPAID_THROTTLE_EVENT' elapsed='3 ms'>
    <message>project 'POSTPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_postpaid_throttle_event'</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:28:06 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_prepaid_throttle_event' project='PREPAID_THROTTLE_EVENT' elapsed='3 ms'>
    <message>project 'PREPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_prepaid_throttle_event'</message>
</response>

<response action='remove' name='POSTPAID_THROTTLE_EVENT' elapsed='1283 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:28:09 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_fonic_throttle_event' project='FONIC_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'FONIC_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_fonic_throttle_event'</message>
</response>

<response action='remove' name='PREPAID_THROTTLE_EVENT' elapsed='1299 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_stop.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_ENGINE.sh  
killing 5272..
waiting on the following processes to stop..
5272
ending tc2 at Mon Apr  7 00:28:15 PDT 2014..
############################################################################
############################################################################
starting tc3 at Mon Apr  7 00:28:15 PDT 2014..
running test at Mon Apr  7 00:28:16 PDT 2014
TC3:
R3: The Quota Total is defined as the total usage amount 
For a given throttle 100 event. For example 3 usage events
followed by 1 throttle event would result in all the usage
from all 4 EDRs.
 
test strategy:
we have 2 usage ERDs followed by a throttle 100 postpaid event
The total usage should therefore be the total of these 3 EDRs
another usage event after this should be ignored
 
 
EDR data setup:
Row1: a POSTPAID usage EDR (usage=1) (Quota_Status1=16)
Row2: a POSTPAID usage EDR (usage=10)
Row3: a POSTPAID Postpaid throttle EDR (usage=100)
Row4: a POSTPAID usage event (usage=1000) - ignored
 
 

tc3: 1. PCRD EDRs (input stream)..
tc3: 2. postpaid lkp..
tc3: 3. recurring lkp..
debug Quota_Usage1=1
debug Quota_Usage2=10
debug Quota_Usage3=100
debug All 3=111
tc3: 4. generating the expected output..
 
here is the contents we were looking for..
I,N:2014-04-07 00:20:16,4912345678901,Q_110_local_Month,2014-04-23 00:28:16,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,111,N,1777
 
here is the postpaid lookup we used..
4912345678901,POSTPAID
 
here is the recurring lookup we used..
4912345678901,Q_111_local_Month,1230,Y
4912345678901,Q_110_local_Month,1777,N
 
here is the EDR stream we used..
2,2014-04-07 00:18:16,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,16,,,,1,2014-04-23 00:28:16,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:19:16,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,16,,,,10,2014-04-23 00:28:16,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:20:16,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,100,2014-04-23 00:28:16,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:21:16,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,16,,,,1000,2014-04-23 00:28:16,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
calling ./START_CEP_ENGINE.sh  
cd /home/sal/Desktop/dev/2.2-pre/bin
starting the cep server at Mon Apr  7 00:28:16 PDT 2014..
./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt >> /home/sal/sals_tests/cep_server.log
running in the following cep server process..
sal       5800  1.0  0.8 518080 15828 pts/0    Sl+  00:28   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
calling ./START_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:28:19 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_load.xml
<response action='load' name='POSTPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='28 ms'>
    <message>project load POSTPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_postpaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:28:22 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_load.xml
<response action='load' name='PREPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='25 ms'>
    <message>project load PREPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_prepaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:28:25 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_load.xml
<response action='load' name='FONIC_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='25 ms'>
    <message>project load FONIC_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_start.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_fonic_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_ADAPTER.sh  
cd /home/sal/sals_tests/try9
starting the cep adapter.. java -jar o2-adapters-pcrf-2.12.2_external_camel_context.jar >> /home/sal/sals_tests/cep_adapter.log
running in the following cep adapter process..
sal       5800  1.1  1.6 1319512 31596 pts/0   Sl+  00:28   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
waiting for /opt/app/sas/custom/data/output_postpaid/result.csv to be created..
waiting for /opt/app/sas/custom/data/output_postpaid/result.csv to be created..
tc3:11. now we can compare results..
here is the contents we were looking for..
I,N:2014-04-07 00:20:16,4912345678901,Q_110_local_Month,2014-04-23 00:28:16,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,111,N,1777
here is what we got..
I,N:2014-04-07 00:20:16,4912345678901,Q_110_local_Month,2014-04-23 00:28:16,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,100,,,,,,,,,,POSTPAID,111,N,1777
tc3: RESULT: FAILURE!!! (no bad files expected but some were found.. tc3_EDR_UPCC231_MPU484_4924_40131211100031.csv.gz)
calling ./STOP_CEP_ADAPTER.sh  
killing 5971..
waiting on the following processes to stop..
5971
calling ./STOP_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:28:45 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_postpaid_throttle_event' project='POSTPAID_THROTTLE_EVENT' elapsed='3 ms'>
    <message>project 'POSTPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_postpaid_throttle_event'</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:28:48 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_prepaid_throttle_event' project='PREPAID_THROTTLE_EVENT' elapsed='3 ms'>
    <message>project 'PREPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_prepaid_throttle_event'</message>
</response>

<response action='remove' name='POSTPAID_THROTTLE_EVENT' elapsed='1151 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:28:51 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_fonic_throttle_event' project='FONIC_THROTTLE_EVENT' elapsed='4 ms'>
    <message>project 'FONIC_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_fonic_throttle_event'</message>
</response>

<response action='remove' name='PREPAID_THROTTLE_EVENT' elapsed='1156 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_stop.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_ENGINE.sh  
killing 5800..
waiting on the following processes to stop..
5800
ending tc3 at Mon Apr  7 00:28:57 PDT 2014..
############################################################################
############################################################################
starting tc4 at Mon Apr  7 00:28:57 PDT 2014..
running test at Mon Apr  7 00:28:57 PDT 2014
TC4:
R4: The 48 Hour Usage Aggregation 
Is defined as the total usage within the past 48 hours from the throttle 100 postpaid event
usage events before or after this throttle 100 event should not effect this total.
 
test strategy:
we add various usage and throttle events and make sure we have
a mix of usage EDRs which are relevant for 1 or more throtte 100 events
and some usage EDRs which are not relevant for any throttle 100 events.
 
 
EDR data setup:
Row1: Postpaid usageA (1) - 50 hours ago (no relevant for any throttle events)
Row2: Postpaid usageB (2) - 49 hours ago (relevant for Throttle1 only)
Row3: Postpaid usageC (4) - 48 hours ago (relevant for Throttle1 and Throttle2)
Row4: Postpaid Throttle1 (8) - 2 hours ago (the total usage includes usageB and usageC (and Throttle1) )
Row5: Postpaid usageD (16) - 3 minutes ago (relevant for Throttle2 only)
Row6: Postpaid Throttle2 (32) - 2 minutes ago (the total usage includes usageC, Throttle1, usageD (and Throttle2) )
Row7: Postpaid usageE (64) - 1 minute ago (not relevant for any throttle events)
 
 

tc4: 1. PCRD EDRs (input stream)..
tc4: 2. postpaid lkp..
tc4: 3. recurring lkp..
tc4: 4. generating the expected output..
 
here is the contents we were looking for..
I,N:2014-04-06 22:28:57,4912345678901,Q_110_local_Month,2014-04-23 00:28:57,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,8,,,,,,,,,,POSTPAID,14,N,1777
I,N:2014-04-07 00:26:57,4912345678901,Q_110_local_Month,2014-04-23 00:28:57,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,32,,,,,,,,,,POSTPAID,60,N,1777
 
here is the postpaid lookup we used..
4912345678901,POSTPAID
 
here is the recurring lookup we used..
4912345678901,Q_111_local_Month,1230,Y
4912345678901,Q_110_local_Month,1777,N
 
here is the EDR stream we used..
2,2014-04-04 22:28:57,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,16,,,,1,2014-04-23 00:28:57,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-04 23:28:57,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,16,,,,2,2014-04-23 00:28:57,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-05 00:28:57,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,16,,,,4,2014-04-23 00:28:57,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-06 22:28:57,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,8,2014-04-23 00:28:57,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:25:57,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,26,,,,16,2014-04-23 00:28:57,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:26:57,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,32,2014-04-23 00:28:57,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:27:57,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,26,,,,64,2014-04-23 00:28:57,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
calling ./START_CEP_ENGINE.sh  
cd /home/sal/Desktop/dev/2.2-pre/bin
starting the cep server at Mon Apr  7 00:28:58 PDT 2014..
./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt >> /home/sal/sals_tests/cep_server.log
running in the following cep server process..
sal       6335  0.7  0.7 518080 13784 pts/0    Sl+  00:28   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
calling ./START_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:29:01 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_load.xml
<response action='load' name='POSTPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='28 ms'>
    <message>project load POSTPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_postpaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:29:04 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_load.xml
<response action='load' name='PREPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='25 ms'>
    <message>project load PREPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_prepaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:29:07 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_load.xml
<response action='load' name='FONIC_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='23 ms'>
    <message>project load FONIC_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_start.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_fonic_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_ADAPTER.sh  
cd /home/sal/sals_tests/try9
starting the cep adapter.. java -jar o2-adapters-pcrf-2.12.2_external_camel_context.jar >> /home/sal/sals_tests/cep_adapter.log
running in the following cep adapter process..
sal       6335  0.9  1.5 1319512 29564 pts/0   Sl+  00:28   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
waiting for /opt/app/sas/custom/data/output_postpaid/result.csv to be created..
tc4:11. now we can compare results..
here is the contents we were looking for..
I,N:2014-04-06 22:28:57,4912345678901,Q_110_local_Month,2014-04-23 00:28:57,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,8,,,,,,,,,,POSTPAID,14,N,1777
I,N:2014-04-07 00:26:57,4912345678901,Q_110_local_Month,2014-04-23 00:28:57,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,32,,,,,,,,,,POSTPAID,60,N,1777
here is what we got..
I,N:2014-04-06 22:28:57,4912345678901,Q_110_local_Month,2014-04-23 00:28:57,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,8,,,,,,,,,,POSTPAID,14,N,1777
I,N:2014-04-07 00:26:57,4912345678901,Q_110_local_Month,2014-04-23 00:28:57,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,32,,,,,,,,,,POSTPAID,60,N,1777
tc4: RESULT: FAILURE!!! (no bad files expected but some were found.. tc4_EDR_UPCC231_MPU484_4924_40131211100031.csv.gz)
calling ./STOP_CEP_ADAPTER.sh  
killing 6506..
waiting on the following processes to stop..
6506
calling ./STOP_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:29:23 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_postpaid_throttle_event' project='POSTPAID_THROTTLE_EVENT' elapsed='3 ms'>
    <message>project 'POSTPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_postpaid_throttle_event'</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:29:26 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_prepaid_throttle_event' project='PREPAID_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'PREPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_prepaid_throttle_event'</message>
</response>

<response action='remove' name='POSTPAID_THROTTLE_EVENT' elapsed='1305 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:29:29 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_fonic_throttle_event' project='FONIC_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'FONIC_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_fonic_throttle_event'</message>
</response>

<response action='remove' name='PREPAID_THROTTLE_EVENT' elapsed='1307 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_stop.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_ENGINE.sh  
killing 6335..
waiting on the following processes to stop..
6335
ending tc4 at Mon Apr  7 00:29:35 PDT 2014..
############################################################################
############################################################################
starting tc5 at Mon Apr  7 00:29:35 PDT 2014..
running test at Mon Apr  7 00:29:35 PDT 2014
TC5:
R1: the CEP Engine delivers POSTPAID throttle 100 events with various metrics.
EDRs which have a local QuotaName and TriggerType 1 to 6 are of interest.
Throttle 100 events have the QuotaStatus=6 and QuotaValue=1.
 
 
test strategy:
we try various valid and invalid prepaid throttle 100 events and make sure
the good ones are cleanly processed and none are skipped (this was a bug in the CEP engine!!!!)
 
EDR data setup:
Row1: a valid prepaid throttle 100 event (Quota_Name=Q_110_local_Month, TriggerType=2, Quota_Status=6, QuotaValue=1)
Row2: a valid prepaid throttle 100 event
Row3: a not valid prepaid throttle 100 event (TriggerType=7 instead of 1-6)
Row4: a not valid prepaid throttle 100 event (Quota_Status=4 instead of 6)
Row5: a not valid prepaid throttle 100 event (QuotaValue=11 instead of 1)
Row6: a POSTPAID throttle 100 event - it should be igonored
Row7: a FONIC throttle 100 event - it should be igonored
Row8: a prepaid throttle 100 event - it should be processed
Row9: a not valid prepaid throttle 100 event (Quota_Name = Q_110_roaming_Month)
 

TC5: 1. PCRD EDRs (input stream)..
TC5: 2. prepaid lkp..
TC5: 3. recurring lkp..
TC5: 4. generating the expected output..
 
here is the contents we were looking for..
I,N:2014-04-07 00:29:35,4912345678901,Q_110_local_Month,2014-04-23 00:29:35,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,PREPAID,1024,Y,1230
I,N:2014-04-07 00:29:35,4912345678902,Q_110_local_Month,2014-04-23 00:29:35,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,PREPAID,1024,Y,1230
I,N:2014-04-07 00:29:35,4912345678908,Q_110_local_Month,2014-04-23 00:29:35,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,PREPAID,1024,Y,1230
 
here is the prepaid lookup we used..
4912345678901,PREPAID
4912345678902,PREPAID
4912345678903,PREPAID
4912345678904,PREPAID
4912345678905,PREPAID
4912345678906,POSTPAID
4912345678907,FONIC
4912345678908,PREPAID
4912345678909,POSTPAID
 
here is the recurring lookup we used..
4912345678901,Q_110_local_Month,1230,Y
4912345678902,Q_110_local_Month,1230,Y
4912345678903,Q_110_local_Month,1230,Y
4912345678904,Q_110_local_Month,1230,Y
4912345678908,Q_110_local_Month,1230,Y
 
here is the EDR stream we used..
2,2014-04-07 00:29:35,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:29:35,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:29:35,,,4912345678902,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:29:35,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
7,2014-04-07 00:29:35,,,4912345678903,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:29:35,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:29:35,,,4912345678904,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,4,,,,1024,2014-04-23 00:29:35,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:29:35,,,4912345678905,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:29:35,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,11,,
2,2014-04-07 00:29:35,,,4912345678906,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:29:35,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:29:35,,,4912345678907,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:29:35,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:29:35,,,4912345678908,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1024,2014-04-23 00:29:35,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:29:35,,,4912345678909,,,,,,,,,,,,,,,,,,,,,,Q_110_roaming_Month,6,,,,1024,2014-04-23 00:29:35,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
calling ./START_CEP_ENGINE.sh  
cd /home/sal/Desktop/dev/2.2-pre/bin
starting the cep server at Mon Apr  7 00:29:35 PDT 2014..
./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt >> /home/sal/sals_tests/cep_server.log
running in the following cep server process..
sal       6860  0.7  0.7 518076 13788 pts/0    Sl+  00:29   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
calling ./START_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:29:38 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_load.xml
<response action='load' name='POSTPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='18 ms'>
    <message>project load POSTPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_postpaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:29:41 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_load.xml
<response action='load' name='PREPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='17 ms'>
    <message>project load PREPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_prepaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:29:44 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_load.xml
<response action='load' name='FONIC_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='22 ms'>
    <message>project load FONIC_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_start.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_fonic_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_ADAPTER.sh  
cd /home/sal/sals_tests/try9
starting the cep adapter.. java -jar o2-adapters-pcrf-2.12.2_external_camel_context.jar >> /home/sal/sals_tests/cep_adapter.log
running in the following cep adapter process..
sal       6860  0.8  1.4 1319508 27548 pts/0   Sl+  00:29   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
waiting for /opt/app/sas/custom/data/output_prepaid/result.csv to be created..
tc5:11. now we can compare results..
here is the contents we were looking for..
I,N:2014-04-07 00:29:35,4912345678901,Q_110_local_Month,2014-04-23 00:29:35,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,PREPAID,1024,Y,1230
I,N:2014-04-07 00:29:35,4912345678902,Q_110_local_Month,2014-04-23 00:29:35,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,PREPAID,1024,Y,1230
I,N:2014-04-07 00:29:35,4912345678908,Q_110_local_Month,2014-04-23 00:29:35,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,PREPAID,1024,Y,1230
here is what we got..
I,N:2014-04-07 00:29:35,4912345678901,Q_110_local_Month,2014-04-23 00:29:35,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,PREPAID,1024,Y,1230
I,N:2014-04-07 00:29:35,4912345678902,Q_110_local_Month,2014-04-23 00:29:35,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,PREPAID,1024,Y,1230
I,N:2014-04-07 00:29:35,4912345678908,Q_110_local_Month,2014-04-23 00:29:35,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1024,,,,,,,,,,PREPAID,1024,Y,1230
tc5: RESULT: FAILURE!!! (no bad files expected but some were found.. tc5_EDR_UPCC231_MPU484_4924_40131211100031.csv.gz)
calling ./STOP_CEP_ADAPTER.sh  
killing 7039..
waiting on the following processes to stop..
7039
calling ./STOP_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:30:00 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_postpaid_throttle_event' project='POSTPAID_THROTTLE_EVENT' elapsed='3 ms'>
    <message>project 'POSTPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_postpaid_throttle_event'</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:30:03 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_prepaid_throttle_event' project='PREPAID_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'PREPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_prepaid_throttle_event'</message>
</response>

<response action='remove' name='POSTPAID_THROTTLE_EVENT' elapsed='1275 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:30:06 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_fonic_throttle_event' project='FONIC_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'FONIC_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_fonic_throttle_event'</message>
</response>

<response action='remove' name='PREPAID_THROTTLE_EVENT' elapsed='1274 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_stop.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_ENGINE.sh  
killing 6860..
waiting on the following processes to stop..
6860
ending tc5 at Mon Apr  7 00:30:12 PDT 2014..
############################################################################
############################################################################
starting tc6 at Mon Apr  7 00:30:12 PDT 2014..
running test at Mon Apr  7 00:30:12 PDT 2014
tc6:
R5: Persist and Restore
when the CEP Engine and CEP Adapter are stopped, the aggregated data is persisted
and is restored at startup (via CEP Model Persist and Restore). This means no 
aggregated data is lost.
 
test strategy:
we add various usage and throttle events and make sure we have
a mix of usage EDRs which are relevant for 1 or more throtte 100 events
and some usage EDRs which are not relevant for any throttle 100 events.
 
 
EDR data setup:
Row1: Postpaid usageA (1) - 51 hours ago (no relevant for any throttle events)
Row2: Postpaid usageB (2) - 49 hours ago (relevant for Throttle1 only)
stop cep
start cep
Row3: Postpaid usageC (4) - 48 hours ago (relevant for Throttle1 and Throttle2)
Row4: Postpaid Throttle1 (8) - 2 hours ago (the total usage includes usageB and usageC (and Throttle1) )
Row5: Postpaid usageD (16) - 3 minutes ago (relevant for Throttle2 only)
Row6: Postpaid Throttle2 (32) - 2 minutes ago (the total usage includes usageC, Throttle1, usageD (and Throttle2) )
Row7: Postpaid usageE (64) - 1 minute ago (not relevant for any throttle events)
 
 

tc6: 1. PCRD EDRs (input stream)..
mv input_data/tc6_EDR_UPCC231_MPU484_4924_40131211100031.csv input_data/atc6_EDR_UPCC231_MPU484_4924_40131211100031.csv
rm -f input_data/atc6_EDR_UPCC231_MPU484_4924_40131211100031.csv.gz
gzip input_data/atc6_EDR_UPCC231_MPU484_4924_40131211100031.csv
cp input_data/atc6_EDR_UPCC231_MPU484_4924_40131211100031.csv.gz /opt/app/sas/custom/data/pcrf_files_postpaid/
tc6: 2. postpaid lkp..
tc6: 3. recurring lkp..
starting the cep components...
calling ./START_CEP_ENGINE.sh  
cd /home/sal/Desktop/dev/2.2-pre/bin
starting the cep server at Mon Apr  7 00:30:13 PDT 2014..
./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt >> /home/sal/sals_tests/cep_server.log
running in the following cep server process..
sal       7370  0.7  0.7 518076 13792 pts/0    Sl+  00:30   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
calling ./START_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:30:16 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_load.xml
<response action='load' name='POSTPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='26 ms'>
    <message>project load POSTPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_postpaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:30:19 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_load.xml
<response action='load' name='PREPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='25 ms'>
    <message>project load PREPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_prepaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:30:22 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_load.xml
<response action='load' name='FONIC_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='23 ms'>
    <message>project load FONIC_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_start.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_fonic_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_ADAPTER.sh  
cd /home/sal/sals_tests/try9
starting the cep adapter.. java -jar o2-adapters-pcrf-2.12.2_external_camel_context.jar >> /home/sal/sals_tests/cep_adapter.log
running in the following cep adapter process..
sal       7370  0.9  1.5 1319508 29572 pts/0   Sl+  00:30   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
stopping the cep components...
calling ./STOP_CEP_ADAPTER.sh  
killing 7540..
calling ./STOP_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:30:26 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_postpaid_throttle_event' project='POSTPAID_THROTTLE_EVENT' elapsed='3 ms'>
    <message>project 'POSTPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_postpaid_throttle_event'</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:30:29 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_prepaid_throttle_event' project='PREPAID_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'PREPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_prepaid_throttle_event'</message>
</response>

<response action='remove' name='POSTPAID_THROTTLE_EVENT' elapsed='1460 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:30:32 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_fonic_throttle_event' project='FONIC_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'FONIC_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_fonic_throttle_event'</message>
</response>

<response action='remove' name='PREPAID_THROTTLE_EVENT' elapsed='1457 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_stop.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_ENGINE.sh  
killing 7370..
waiting on the following processes to stop..
7370
tc6: 2. postpaid lkp..
tc6: 3. recurring lkp..
tc6: 4. generating the expected output..
Quota_Usage2=2, Quota_Usage3=4, Quota_Usage4=8, total=14
 
here is the contents we were looking for..
I,N:2014-04-06 22:30:39,4912345678901,Q_110_local_Month,2014-04-23 00:30:12,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,8,,,,,,,,,,POSTPAID,14,N,1777
I,N:2014-04-07 00:28:39,4912345678901,Q_110_local_Month,2014-04-23 00:30:12,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,32,,,,,,,,,,POSTPAID,60,N,1777
 
here is the postpaid lookup we used..
4912345678901,POSTPAID
 
here is the recurring lookup we used..
4912345678901,Q_111_local_Month,1230,Y
4912345678901,Q_110_local_Month,1777,N
 
here is the EDR stream we used..
2,2014-04-05 00:30:39,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,16,,,,4,2014-04-23 00:30:12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-06 22:30:39,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,8,2014-04-23 00:30:12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:27:39,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,26,,,,16,2014-04-23 00:30:12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:28:39,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,32,2014-04-23 00:30:12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-07 00:29:39,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,26,,,,64,2014-04-23 00:30:12,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
calling ./START_CEP_ENGINE.sh  
cd /home/sal/Desktop/dev/2.2-pre/bin
starting the cep server at Mon Apr  7 00:30:39 PDT 2014..
./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt >> /home/sal/sals_tests/cep_server.log
running in the following cep server process..
sal       7760  1.0  0.8 518076 15824 pts/0    Sl+  00:30   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
calling ./START_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:30:42 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_load.xml
<response action='load' name='POSTPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='26 ms'>
    <message>project load POSTPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_postpaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:30:45 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_load.xml
<response action='load' name='PREPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='26 ms'>
    <message>project load PREPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_prepaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:30:48 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_load.xml
<response action='load' name='FONIC_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='24 ms'>
    <message>project load FONIC_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_start.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_fonic_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_ADAPTER.sh  
cd /home/sal/sals_tests/try9
starting the cep adapter.. java -jar o2-adapters-pcrf-2.12.2_external_camel_context.jar >> /home/sal/sals_tests/cep_adapter.log
running in the following cep adapter process..
sal       7760  1.0  1.6 1319508 31600 pts/0   Sl+  00:30   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
waiting for /opt/app/sas/custom/data/output_postpaid/result.csv to be created..
tc6:11. now we can compare results..
here is the contents we were looking for..
I,N:2014-04-06 22:30:39,4912345678901,Q_110_local_Month,2014-04-23 00:30:12,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,8,,,,,,,,,,POSTPAID,14,N,1777
I,N:2014-04-07 00:28:39,4912345678901,Q_110_local_Month,2014-04-23 00:30:12,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,32,,,,,,,,,,POSTPAID,60,N,1777
here is what we got..
I,N:2014-04-06 22:30:39,4912345678901,Q_110_local_Month,2014-04-23 00:30:12,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,8,,,,,,,,,,POSTPAID,14,N,1777
I,N:2014-04-07 00:28:39,4912345678901,Q_110_local_Month,2014-04-23 00:30:12,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,32,,,,,,,,,,POSTPAID,60,N,1777
tc6: RESULT: FAILURE!!! (no bad files expected but some were found.. atc6_EDR_UPCC231_MPU484_4924_40131211100031.csv.gz
tc6_EDR_UPCC231_MPU484_4924_40131211100031.csv.gz)
calling ./STOP_CEP_ADAPTER.sh  
killing 7931..
waiting on the following processes to stop..
7931
calling ./STOP_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:31:04 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_postpaid_throttle_event' project='POSTPAID_THROTTLE_EVENT' elapsed='3 ms'>
    <message>project 'POSTPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_postpaid_throttle_event'</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:31:07 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_prepaid_throttle_event' project='PREPAID_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'PREPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_prepaid_throttle_event'</message>
</response>

<response action='remove' name='POSTPAID_THROTTLE_EVENT' elapsed='1321 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:31:10 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_fonic_throttle_event' project='FONIC_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'FONIC_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_fonic_throttle_event'</message>
</response>

<response action='remove' name='PREPAID_THROTTLE_EVENT' elapsed='1312 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_stop.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_ENGINE.sh  
killing 7760..
waiting on the following processes to stop..
7760
ending tc6 at Mon Apr  7 00:31:16 PDT 2014..
############################################################################
############################################################################
starting tc7 at Mon Apr  7 00:31:16 PDT 2014..
running test at Mon Apr  7 00:31:16 PDT 2014
tc7:
R7: Corrupted files dont make things break!
we send in a txt and name it .gz and see if everything breaks!
 
test strategy:
we add a text file instead of a gzip file, then we add a valid file
 
 
EDR data setup:
file 1: a valid gzip file with 1 throttle event
file 2: txt file saved as gzip file
 
 

tc7: 2. postpaid lkp..
tc7: 3. recurring lkp..
tc7: 4. generating the expected output..
 
here is the contents we were looking for..
I,N:2014-04-06 22:31:16,4912345678901,Q_110_local_Month,2014-04-23 00:31:16,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,1230
 
here is the postpaid lookup we used..
4912345678901,POSTPAID
 
here is the recurring lookup we used..
4912345678901,Q_110_local_Month,1230,Y
 
here is the EDR stream we used.. (this is the valid file)
2,2014-04-06 22:31:16,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1,2014-04-23 00:31:16,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
calling ./START_CEP_ENGINE.sh  
cd /home/sal/Desktop/dev/2.2-pre/bin
starting the cep server at Mon Apr  7 00:31:16 PDT 2014..
./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt >> /home/sal/sals_tests/cep_server.log
running in the following cep server process..
sal       8265  0.7  0.7 518076 13788 pts/0    Sl+  00:31   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
calling ./START_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:31:19 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_load.xml
<response action='load' name='POSTPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='20 ms'>
    <message>project load POSTPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_postpaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:31:23 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_load.xml
<response action='load' name='PREPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='25 ms'>
    <message>project load PREPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_prepaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:31:26 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_load.xml
<response action='load' name='FONIC_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='23 ms'>
    <message>project load FONIC_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_start.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_fonic_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_ADAPTER.sh  
cd /home/sal/sals_tests/try9
starting the cep adapter.. java -jar o2-adapters-pcrf-2.12.2_external_camel_context.jar >> /home/sal/sals_tests/cep_adapter.log
running in the following cep adapter process..
sal       8265  0.9  1.5 1319508 29552 pts/0   Sl+  00:31   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
waiting for /opt/app/sas/custom/data/output_postpaid/result.csv to be created..
tc7:11. now we can compare results..
here is the contents we were looking for..
I,N:2014-04-06 22:31:16,4912345678901,Q_110_local_Month,2014-04-23 00:31:16,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,1230
here is what we got..
I,N:2014-04-06 22:31:16,4912345678901,Q_110_local_Month,2014-04-23 00:31:16,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,1230
tc7: RESULT: FAILURE!!! (no bad files expected but some were found.. tc7_EDR_UPCC231_MPU484_4924_40131211100031.csv.gz)
calling ./STOP_CEP_ADAPTER.sh  
killing 8436..
waiting on the following processes to stop..
8436
calling ./STOP_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:31:41 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_postpaid_throttle_event' project='POSTPAID_THROTTLE_EVENT' elapsed='3 ms'>
    <message>project 'POSTPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_postpaid_throttle_event'</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:31:44 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_prepaid_throttle_event' project='PREPAID_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'PREPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_prepaid_throttle_event'</message>
</response>

<response action='remove' name='POSTPAID_THROTTLE_EVENT' elapsed='1299 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:31:47 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_fonic_throttle_event' project='FONIC_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'FONIC_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_fonic_throttle_event'</message>
</response>

<response action='remove' name='PREPAID_THROTTLE_EVENT' elapsed='1293 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_stop.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_ENGINE.sh  
killing 8265..
waiting on the following processes to stop..
8265
ending tc7 at Mon Apr  7 00:31:54 PDT 2014..
############################################################################
############################################################################
starting tc88 at Mon Apr  7 00:31:54 PDT 2014..
running test at Mon Apr  7 00:31:54 PDT 2014
tc8:
R8: Changes to the lookups are used as soon as they are made available
 
test strategy:
we add a text file instead of a gzip file, then we add a valid file
 
 
EDR data setup:
file 1: 
msisdn1 throttle100 event
msisdn2 throttle100 event
msisdn3 throttle100 event

Recurring Lookup
isRecurring=Y for all

Payment Type Lookup:
msisdn1 postpaid
msisdn2 postpaid
msisdn3 postpaid

start cep
all 3 throttle 100 postpaid reach the output


load a new Payment Type Lookup:
msisdn1 postpaid
msisdn2 prepaid
msisdn3 fonic

only msisdn2 should reach the output

Payment Type Lookup:
msisdn1 postpaid
msisdn2 postpaid
msisdn3 postpaid

Recurring Lookup
isRecurring=N for all


starting the cep components...
calling ./START_CEP_ENGINE.sh  
cd /home/sal/Desktop/dev/2.2-pre/bin
starting the cep server at Mon Apr  7 00:31:54 PDT 2014..
./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt >> /home/sal/sals_tests/cep_server.log
running in the following cep server process..
sal       8735  0.7  0.8 518076 15828 pts/0    Sl+  00:31   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
calling ./START_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:31:57 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_load.xml
<response action='load' name='POSTPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='25 ms'>
    <message>project load POSTPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_postpaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:32:00 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_load.xml
<response action='load' name='PREPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='24 ms'>
    <message>project load PREPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_prepaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:32:03 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_load.xml
<response action='load' name='FONIC_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='23 ms'>
    <message>project load FONIC_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_start.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_fonic_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_ADAPTER.sh  
cd /home/sal/sals_tests/try9
starting the cep adapter.. java -jar o2-adapters-pcrf-2.12.2_external_camel_context.jar >> /home/sal/sals_tests/cep_adapter.log
running in the following cep adapter process..
sal       8735  1.0  1.6 1319508 31608 pts/0   Sl+  00:31   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
now we move the paymenttype lkp into the cep engine..
now we move the recurring lkp into the cep engine..
now we move the EDRs into the cep engine..
tc8: part1..
here is the postpaid lookup we used..
4912345678901,POSTPAID
4912345678902,POSTPAID
4912345678903,POSTPAID
 
here is the recurring lookup we used..
4912345678901,Q_110_local_Month,1230,Y
4912345678902,Q_110_local_Month,1230,Y
4912345678903,Q_110_local_Month,1230,Y
 
here is the EDR stream we used..
2,2014-04-06 22:32:07,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1,2014-04-23 00:32:07,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-06 22:32:07,,,4912345678902,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1,2014-04-23 00:32:07,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-06 22:32:07,,,4912345678903,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1,2014-04-23 00:32:07,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,

here is the 2nd file we send off..

####################################################
part2..
now we change the lookups so that msisdn2 is prepaid and msisdn3 is fonic
here is the postpaid lookup we used..
4912345678901,POSTPAID
4912345678902,PREPAID
4912345678903,FONIC
 
here is the EDR stream we used.. (this is the valid file)
2,2014-04-06 23:42:08,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1,2014-04-23 00:32:07,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-06 23:42:08,,,4912345678902,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1,2014-04-23 00:32:07,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-06 23:42:08,,,4912345678903,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1,2014-04-23 00:32:07,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
now we move the paymenttype lkp into the cep engine..
now we move the EDR stream into the cep engine..

####################################################

here is the 3rd file we send off..
####################################################

####################################################
part3..
now we change the lookups so that all are postpaid and isRecurring=N
now we move the paymenttype lkp into the cep engine..
now we move the recurring lkp into the cep engine..
now we move the EDR Stream into the cep engine..
here is the postpaid lookup we used..
4912345678901,POSTPAID
4912345678902,POSTPAID
4912345678903,POSTPAID
 
here is the recurring lookup we used..
4912345678901,Q_110_local_Month,5,N
4912345678902,Q_110_local_Month,5,N
4912345678903,Q_110_local_Month,5,N
 
here is the EDR stream we used.. (this is the valid file)
2,2014-04-06 23:52:08,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1,2014-04-23 00:32:07,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-06 23:52:08,,,4912345678902,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1,2014-04-23 00:32:07,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-06 23:52:08,,,4912345678903,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1,2014-04-23 00:32:07,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,

stopping the cep components...(as it will be started by the main testing framework
calling ./STOP_CEP_ADAPTER.sh  
killing 8906..
calling ./STOP_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:32:08 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_postpaid_throttle_event' project='POSTPAID_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'POSTPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_postpaid_throttle_event'</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:32:11 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_prepaid_throttle_event' project='PREPAID_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'PREPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_prepaid_throttle_event'</message>
</response>

<response action='remove' name='POSTPAID_THROTTLE_EVENT' elapsed='1660 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:32:14 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_fonic_throttle_event' project='FONIC_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'FONIC_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_fonic_throttle_event'</message>
</response>

<response action='remove' name='PREPAID_THROTTLE_EVENT' elapsed='1661 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_stop.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_ENGINE.sh  
killing 8735..
waiting on the following processes to stop..
8735
 
here is the contents we were looking for..
I,N:2014-04-06 22:32:07,4912345678901,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,1230
I,N:2014-04-06 22:32:07,4912345678902,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,1230
I,N:2014-04-06 22:32:07,4912345678903,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,1230
I,N:2014-04-06 23:42:08,4912345678901,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,2,Y,1230
I,N:2014-04-06 23:52:08,4912345678901,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,3,N,5
I,N:2014-04-06 23:52:08,4912345678902,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,2,N,5
I,N:2014-04-06 23:52:08,4912345678903,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,2,N,5
 
calling ./START_CEP_ENGINE.sh  
cd /home/sal/Desktop/dev/2.2-pre/bin
starting the cep server at Mon Apr  7 00:32:21 PDT 2014..
./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt >> /home/sal/sals_tests/cep_server.log
running in the following cep server process..
sal       9154  0.7  0.8 518076 15828 pts/0    Sl+  00:32   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
calling ./START_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:32:24 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_load.xml
<response action='load' name='POSTPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='29 ms'>
    <message>project load POSTPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_postpaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:32:27 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_load.xml
<response action='load' name='PREPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='25 ms'>
    <message>project load PREPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_prepaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:32:30 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_load.xml
<response action='load' name='FONIC_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='23 ms'>
    <message>project load FONIC_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_start.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_fonic_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_ADAPTER.sh  
cd /home/sal/sals_tests/try9
starting the cep adapter.. java -jar o2-adapters-pcrf-2.12.2_external_camel_context.jar >> /home/sal/sals_tests/cep_adapter.log
running in the following cep adapter process..
sal       9154  1.0  1.6 1319508 31604 pts/0   Sl+  00:32   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
waiting for /opt/app/sas/custom/data/output_postpaid/result.csv to be created..
tc88:11. now we can compare results..
here is the contents we were looking for..
I,N:2014-04-06 22:32:07,4912345678901,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,1230
I,N:2014-04-06 22:32:07,4912345678902,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,1230
I,N:2014-04-06 22:32:07,4912345678903,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,1230
I,N:2014-04-06 23:42:08,4912345678901,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,2,Y,1230
I,N:2014-04-06 23:52:08,4912345678901,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,3,N,5
I,N:2014-04-06 23:52:08,4912345678902,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,2,N,5
I,N:2014-04-06 23:52:08,4912345678903,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,2,N,5
here is what we got..
I,N:2014-04-06 23:42:08,4912345678901,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,N,5
I,N:2014-04-06 23:42:08,4912345678902,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,N,5
I,N:2014-04-06 23:42:08,4912345678903,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,N,5
I,N:2014-04-06 23:52:08,4912345678901,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,2,N,5
I,N:2014-04-06 23:52:08,4912345678902,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,2,N,5
I,N:2014-04-06 23:52:08,4912345678903,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,2,N,5
I,N:2014-04-06 22:32:07,4912345678901,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,3,N,5
I,N:2014-04-06 22:32:07,4912345678902,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,3,N,5
I,N:2014-04-06 22:32:07,4912345678903,Q_110_local_Month,2014-04-23 00:32:07,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,3,N,5
calling ./STOP_CEP_ADAPTER.sh  
killing 9325..
waiting on the following processes to stop..
9325
calling ./STOP_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:32:45 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_postpaid_throttle_event' project='POSTPAID_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'POSTPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_postpaid_throttle_event'</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:32:49 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_prepaid_throttle_event' project='PREPAID_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'PREPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_prepaid_throttle_event'</message>
</response>

<response action='remove' name='POSTPAID_THROTTLE_EVENT' elapsed='1310 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:32:52 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_fonic_throttle_event' project='FONIC_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'FONIC_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_fonic_throttle_event'</message>
</response>

<response action='remove' name='PREPAID_THROTTLE_EVENT' elapsed='1307 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_stop.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_ENGINE.sh  
killing 9154..
waiting on the following processes to stop..
9154
ending tc88 at Mon Apr  7 00:32:58 PDT 2014..
############################################################################
############################################################################
starting tc8 at Mon Apr  7 00:32:58 PDT 2014..
running test at Mon Apr  7 00:32:58 PDT 2014
tc8:
R8: Changes to the lookups are used as soon as they are made available
 
test strategy:
we add a text file instead of a gzip file, then we add a valid file
 
 
EDR data setup:
file 1: 
msisdn1 throttle100 event
msisdn2 throttle100 event
msisdn3 throttle100 event

Recurring Lookup
isRecurring=Y for all

Payment Type Lookup:
msisdn1 postpaid
msisdn2 postpaid
msisdn3 postpaid

start cep
all 3 throttle 100 postpaid reach the output


load a new Payment Type Lookup:
msisdn1 postpaid
msisdn2 prepaid
msisdn3 fonic

only msisdn2 should reach the output

Payment Type Lookup:
msisdn1 postpaid
msisdn2 postpaid
msisdn3 postpaid

Recurring Lookup
isRecurring=N for all


tc8: 2. postpaid lkp..
tc8: 3. recurring lkp..
part1..
here is the postpaid lookup we used..
4912345678901,POSTPAID
4912345678902,POSTPAID
4912345678903,POSTPAID
 
here is the recurring lookup we used..
4912345678901,Q_110_local_Month,1230,Y
4912345678902,Q_110_local_Month,1230,Y
4912345678903,Q_110_local_Month,1230,Y
 
here is the EDR stream we used.. (this is the valid file)
2,2014-04-06 22:32:58,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1,2014-04-23 00:32:58,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-06 22:32:58,,,4912345678902,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1,2014-04-23 00:32:58,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-06 22:32:58,,,4912345678903,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1,2014-04-23 00:32:58,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
starting the cep components...
calling ./START_CEP_ENGINE.sh  
cd /home/sal/Desktop/dev/2.2-pre/bin
starting the cep server at Mon Apr  7 00:32:58 PDT 2014..
./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt >> /home/sal/sals_tests/cep_server.log
running in the following cep server process..
sal       9657  0.7  0.8 518076 15828 pts/0    Sl+  00:32   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
calling ./START_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:33:01 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_load.xml
<response action='load' name='POSTPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='25 ms'>
    <message>project load POSTPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_postpaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:33:04 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_load.xml
<response action='load' name='PREPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='25 ms'>
    <message>project load PREPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_prepaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:33:07 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_load.xml
<response action='load' name='FONIC_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='23 ms'>
    <message>project load FONIC_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_start.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_fonic_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_ADAPTER.sh  
cd /home/sal/sals_tests/try9
starting the cep adapter.. java -jar o2-adapters-pcrf-2.12.2_external_camel_context.jar >> /home/sal/sals_tests/cep_adapter.log
running in the following cep adapter process..
sal       9657  0.9  1.6 1319508 31608 pts/0   Sl+  00:32   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt

####################################################
part2..
now we change the lookups so that msisdn2 is prepaid and msisdn3 is fonic

here is the 2nd file we send off..
here is the postpaid lookup we used..
4912345678901,POSTPAID
4912345678902,PREPAID
4912345678903,FONIC
 
here is the recurring lookup we used..
4912345678901,Q_110_local_Month,1230,Y
4912345678902,Q_110_local_Month,1230,Y
4912345678903,Q_110_local_Month,1230,Y
 
here is the EDR stream we used.. (this is the valid file)
2,2014-04-06 23:43:12,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1,2014-04-23 00:32:58,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-06 23:43:12,,,4912345678902,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1,2014-04-23 00:32:58,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-06 23:43:12,,,4912345678903,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1,2014-04-23 00:32:58,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,

####################################################

####################################################
part3..
now we change the lookups so that all are postpaid and isRecurring=N

here is the 3rd file we send off..
here is the postpaid lookup we used..
4912345678901,POSTPAID
4912345678902,POSTPAID
4912345678903,POSTPAID
 
here is the recurring lookup we used..
4912345678901,Q_110_local_Month,5,Y
4912345678902,Q_110_local_Month,5,Y
4912345678903,Q_110_local_Month,5,Y
 
here is the EDR stream we used.. (this is the valid file)
2,2014-04-06 23:53:12,,,4912345678901,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1,2014-04-23 00:32:58,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-06 23:53:12,,,4912345678902,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1,2014-04-23 00:32:58,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
2,2014-04-06 23:53:12,,,4912345678903,,,,,,,,,,,,,,,,,,,,,,Q_110_local_Month,6,,,,1,2014-04-23 00:32:58,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,
####################################################

stopping the cep components...(as it will be started by the main testing framework
calling ./STOP_CEP_ADAPTER.sh  
killing 9827..
calling ./STOP_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:33:12 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_postpaid_throttle_event' project='POSTPAID_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'POSTPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_postpaid_throttle_event'</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:33:15 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_prepaid_throttle_event' project='PREPAID_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'PREPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_prepaid_throttle_event'</message>
</response>

<response action='remove' name='POSTPAID_THROTTLE_EVENT' elapsed='1134 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:33:18 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_fonic_throttle_event' project='FONIC_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'FONIC_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_fonic_throttle_event'</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_stop.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

<response action='remove' name='PREPAID_THROTTLE_EVENT' elapsed='2127 ms'>
    <message>project  removal succeeded</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_ENGINE.sh  
killing 9657..
waiting on the following processes to stop..
9657
 
here is the contents we were looking for..
I,N:2014-04-06 22:32:58,4912345678901,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,1230
I,N:2014-04-06 22:32:58,4912345678902,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,1230
I,N:2014-04-06 22:32:58,4912345678903,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,1230
I,N:2014-04-06 23:43:12,4912345678901,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,1230
I,N:2014-04-06 23:53:12,4912345678901,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,5
I,N:2014-04-06 23:53:12,4912345678902,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,5
I,N:2014-04-06 23:53:12,4912345678903,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,5
 
calling ./START_CEP_ENGINE.sh  
cd /home/sal/Desktop/dev/2.2-pre/bin
starting the cep server at Mon Apr  7 00:33:25 PDT 2014..
./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt >> /home/sal/sals_tests/cep_server.log
running in the following cep server process..
sal      10047  1.0  0.8 518076 15808 pts/0    Sl+  00:33   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
calling ./START_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:33:28 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_load.xml
<response action='load' name='POSTPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='26 ms'>
    <message>project load POSTPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_postpaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:33:31 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_load.xml
<response action='load' name='PREPAID_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='19 ms'>
    <message>project load PREPAID_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_start.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_prepaid_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) loading the cep model at Mon Apr  7 00:33:34 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_load.xml
<response action='load' name='FONIC_THROTTLE_EVENT' pubsub='auto' threads='4' use-tagged-token='true' elapsed='23 ms'>
    <message>project load FONIC_THROTTLE_EVENT succeeded</message>
</response>

2/3) starting the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_start.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) restoring an existing binaries for this cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_restore.xml
 
<response restore='/opt/app/sas/custom/data/persist_fonic_throttle_event' elapsed='0 ms'/>

calling ./START_CEP_ADAPTER.sh  
cd /home/sal/sals_tests/try9
starting the cep adapter.. java -jar o2-adapters-pcrf-2.12.2_external_camel_context.jar >> /home/sal/sals_tests/cep_adapter.log
running in the following cep adapter process..
sal      10047  0.9  1.5 1319508 29564 pts/0   Sl+  00:33   0:00 ./dfesp_xml_server -pubsub 55555 -server 55556 -loglevel debug -badevents /opt/app/sas/custom/data/bad_server_events/bad_events.txt
waiting for /opt/app/sas/custom/data/output_postpaid/result.csv to be created..
tc8:11. now we can compare results..
here is the contents we were looking for..
I,N:2014-04-06 22:32:58,4912345678901,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,1230
I,N:2014-04-06 22:32:58,4912345678902,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,1230
I,N:2014-04-06 22:32:58,4912345678903,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,1230
I,N:2014-04-06 23:43:12,4912345678901,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,1230
I,N:2014-04-06 23:53:12,4912345678901,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,5
I,N:2014-04-06 23:53:12,4912345678902,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,5
I,N:2014-04-06 23:53:12,4912345678903,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,5
here is what we got..
I,N:2014-04-06 23:43:12,4912345678901,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,5
I,N:2014-04-06 23:43:12,4912345678902,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,5
I,N:2014-04-06 23:43:12,4912345678903,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,1,Y,5
I,N:2014-04-06 23:53:12,4912345678901,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,2,Y,5
I,N:2014-04-06 23:53:12,4912345678902,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,2,Y,5
I,N:2014-04-06 23:53:12,4912345678903,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,2,Y,5
I,N:2014-04-06 22:32:58,4912345678901,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,3,Y,5
I,N:2014-04-06 22:32:58,4912345678902,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,3,Y,5
I,N:2014-04-06 22:32:58,4912345678903,Q_110_local_Month,2014-04-23 00:32:58,2,,,,,,,,,,,,,,,,,,,,,,,,6,,,,1,,,,,,,,,,POSTPAID,3,Y,5
calling ./STOP_CEP_ADAPTER.sh  
killing 10218..
waiting on the following processes to stop..
10218
calling ./STOP_CEP_MODEL.sh POSTPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:33:49 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_postpaid_throttle_event' project='POSTPAID_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'POSTPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_postpaid_throttle_event'</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='POSTPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project POSTPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/POSTPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh PREPAID_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:33:52 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_prepaid_throttle_event' project='PREPAID_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'PREPAID_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_prepaid_throttle_event'</message>
</response>

<response action='remove' name='POSTPAID_THROTTLE_EVENT' elapsed='1310 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_stop.xml
 
<response action='start' name='PREPAID_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project PREPAID_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/PREPAID_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_MODEL.sh FONIC_THROTTLE_EVENT 
cd /home/sal/Desktop/dev/2.2-pre/bin
1/3) persisting the cep model at Mon Apr  7 00:33:56 PDT 2014..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_persist.xml
<response path='/opt/app/sas/custom/data/persist_fonic_throttle_event' project='FONIC_THROTTLE_EVENT' elapsed='2 ms'>
    <message>project 'FONIC_THROTTLE_EVENT' successfully saved to '/opt/app/sas/custom/data/persist_fonic_throttle_event'</message>
</response>

<response action='remove' name='PREPAID_THROTTLE_EVENT' elapsed='1308 ms'>
    <message>project  removal succeeded</message>
</response>

2/3) stopping the cep model..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_stop.xml
 
<response action='start' name='FONIC_THROTTLE_EVENT' elapsed='0 ms'>
    <message>project FONIC_THROTTLE_EVENT started</message>
</response>

3/3) removing the cep model from memory..
./dfesp_xml_client -server localhost.localdomain:55556 -file /home/sal/sals_tests/start_stop_dir/FONIC_THROTTLE_EVENT_remove.xml
 
calling ./STOP_CEP_ENGINE.sh  
killing 10047..
waiting on the following processes to stop..
10047
ending tc8 at Mon Apr  7 00:34:02 PDT 2014..
############################################################################
